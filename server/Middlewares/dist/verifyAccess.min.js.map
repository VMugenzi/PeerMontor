{"version":3,"sources":["verifyAccess.js"],"names":["verifyAccess","requiredRole","req","res","next","role","regeneratorRuntime","async","_context","prev","user","abrupt","status","message","t0","stop"],"mappings":"2FAEA,IAAMA,aAAe,SAASC,GAC1B,OAAO,SAAOC,EAAIC,EAAIC,GAAf,IAAAC,EAAA,OAAAC,mBAAAC,MAAA,SAAAC,GAAA,OAAA,OAAAA,EAAAC,KAAAD,EAAAJ,MAAA,KAAA,EAAA,GAAAI,EAAAC,KAAA,EAGOJ,EAAKH,EAAIQ,KAAKL,KAJdJ,IAAZD,EACK,OAAAQ,EAAAG,OAAA,SAAAR,EAAOD,OAAP,KAAeE,KAAf,CAAAQ,OAAA,IAAAC,QAAA,4BAAAL,EAAAJ,KAAA,EAAA,MAAA,KAAA,EAAA,OAAAI,EAAAG,OAAA,SAAAP,KAAA,KAAA,EAAAI,EAAAC,KAAA,EAAAD,EAAAM,GAAAN,EAAA,MAAA,GAGOH,QAAKH,IAALG,EAAAA,IAHP,KAAA,GAAA,IAAA,MAAA,OAAAG,EAAAO,SAAA,KAAA,KAAA,CAAA,CAAA,EAAA,gBAAAf","file":"verifyAccess.min.js","sourcesContent":["\r\n\r\nconst verifyAccess = function(requiredRole){\r\n    return async (req,res,next)=>{\r\n        try{\r\n            //const {role:role}=req.user (the same as)\r\n            const role=req.user.role;\r\n            if (requiredRole !==role){\r\n                return res.status(403).json({\r\n                    status:403,\r\n                    message:\"you are not authorized\"\r\n                })\r\n            }\r\n            return next();\r\n        }\r\n        catch(err){\r\n            console.log(err);\r\n        }\r\n    }\r\n}\r\nexport default verifyAccess;"]}