{"version":3,"sources":["verifyAccess.js"],"names":["verifyAccess","requiredRole","req","res","next","role","user","status","json","message","console","log"],"mappings":";;;;;;;AAEA,IAAMA,YAAY,GAAG,SAAfA,YAAe,CAASC,YAAT,EAAsB;AACvC,SAAO,iBAAOC,GAAP,EAAWC,GAAX,EAAeC,IAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEC;AACMC,YAAAA,IAHP,GAGYH,GAAG,CAACI,IAAJ,CAASD,IAHrB;;AAAA,kBAIKJ,YAAY,KAAII,IAJrB;AAAA;AAAA;AAAA;;AAAA,6CAKYF,GAAG,CAACI,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACxBD,cAAAA,MAAM,EAAC,GADiB;AAExBE,cAAAA,OAAO,EAAC;AAFgB,aAArB,CALZ;;AAAA;AAAA,6CAUQL,IAAI,EAVZ;;AAAA;AAAA;AAAA;AAaCM,YAAAA,OAAO,CAACC,GAAR;;AAbD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAP;AAgBH,CAjBD;;eAkBeX,Y","sourcesContent":["\r\n\r\nconst verifyAccess = function(requiredRole){\r\n    return async (req,res,next)=>{\r\n        try{\r\n            //const {role:role}=req.user (the same as)\r\n            const role=req.user.role;\r\n            if (requiredRole !==role){\r\n                return res.status(403).json({\r\n                    status:403,\r\n                    message:\"you are not authorized\"\r\n                })\r\n            }\r\n            return next();\r\n        }\r\n        catch(err){\r\n            console.log(err);\r\n        }\r\n    }\r\n}\r\nexport default verifyAccess;"],"file":"verifyAccess.dev.js"}